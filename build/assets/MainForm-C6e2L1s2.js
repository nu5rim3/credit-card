import{c as te,r as ae,b as B,d as se,_ as O,e as _,v as ne,f as re,g as $,R as D,h as j,a as ie,i as U,j as t,k as le,V as oe,q as ce,w as ue,D as de,B as K,m as me,n as fe,o as G,u as pe,p as he,l as ge,I as M}from"./index-eTszT9BU.js";import{m as ve}from"./textConvertor-BsdEMnbp.js";import{o as ye,s as V,u as be,L as xe,t as je}from"./index-DkD_35SZ.js";/**
 * @license lucide-react v0.383.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=te("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Pe=r=>async o=>{var m,c,i,l;o(ae());try{const s=await B.post(`/otp-request/${r}`);o(se(s.data)),O.success(s.data.message??"OTP sent to your mobile")}catch(s){s?(o(_((c=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:c.error)),O.error((l=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:l.error)):o(_("An unknown error occurred"))}},Se=(r,o,m)=>async c=>{var i,l,s,b,v,y,f;c(ne());try{const a=await B.post(`/otp-request/v2/validate/${o}/${m}`);c(re(a.data)),O.success(a.data.message??"OTP code successfully validated!"),((i=a==null?void 0:a.data)==null?void 0:i.stage)==="PENDING"?r("/personal-detail"):((l=a==null?void 0:a.data)==null?void 0:l.stage)==="PENDING_DOCUMENT"?r("/document-detail"):((s=a==null?void 0:a.data)==null?void 0:s.stage)==="COMPLETED"&&r("/complete")}catch(a){a?(c($((v=(b=a==null?void 0:a.response)==null?void 0:b.data)==null?void 0:v.error)),O.error((f=(y=a==null?void 0:a.response)==null?void 0:y.data)==null?void 0:f.error)):c($("An unknown error occurred"))}};var z=function(r){return typeof r=="object"&&r!==null},we=function(r){var o=r.value,m=o===void 0?"":o,c=r.numInputs,i=c===void 0?4:c,l=r.onChange,s=r.onPaste,b=r.renderInput,v=r.shouldAutoFocus,y=v===void 0?!1:v,f=r.inputType,a=f===void 0?"text":f,S=r.renderSeparator,N=r.placeholder,h=r.containerStyle,w=r.inputStyle,T=r.skipDefaultStyles,E=T===void 0?!1:T,C=D.useState(0),u=C[0],I=C[1],g=D.useRef([]),k=function(){return m?m.toString().split(""):[]},L=a==="number"||a==="tel";D.useEffect(function(){g.current=g.current.slice(0,i)},[i]),D.useEffect(function(){var e;y&&((e=g.current[0])===null||e===void 0||e.focus())},[y]);var J=function(){if(typeof N=="string"){if(N.length===i)return N;N.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},F=function(e){var n=L?!isNaN(Number(e)):typeof e=="string";return n&&e.trim().length===1},W=function(e){var n=e.target.value;F(n)&&(A(n),P(u+1))},X=function(e){var n=e.nativeEvent,d=e.target.value;if(!F(d)){if(d.length===i){var p=d.split("").some(function(x){return!F(x)});p||(R(d.split("")),P(i-1))}n.data===null&&n.inputType==="deleteContentBackward"&&(e.preventDefault(),A(""),P(u-1)),e.target.value=""}},H=function(e){return function(n){I(n),e.target.select()}},Q=function(){I(u-1)},Y=function(e){var n=k();[e.code,e.key].includes("Backspace")?(e.preventDefault(),A(""),P(u-1)):e.code==="Delete"?(e.preventDefault(),A("")):e.code==="ArrowLeft"?(e.preventDefault(),P(u-1)):e.code==="ArrowRight"||e.key===n[u]?(e.preventDefault(),P(u+1)):(e.code==="Spacebar"||e.code==="Space"||e.code==="ArrowUp"||e.code==="ArrowDown")&&e.preventDefault()},P=function(e){var n,d,p=Math.max(Math.min(i-1,e),0);g.current[p]&&((n=g.current[p])===null||n===void 0||n.focus(),(d=g.current[p])===null||d===void 0||d.select(),I(p))},A=function(e){var n=k();n[u]=e[0],R(n)},R=function(e){var n=e.join("");l(n)},Z=function(e){var n;e.preventDefault();var d=k(),p=u,x=e.clipboardData.getData("text/plain").slice(0,i-u).split("");if(!(L&&x.some(function(ee){return isNaN(Number(ee))}))){for(var q=0;q<i;++q)q>=u&&x.length>0&&(d[q]=(n=x.shift())!==null&&n!==void 0?n:"",p++);P(p),R(d)}};return D.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},z(h)&&h),className:typeof h=="string"?h:void 0,onPaste:s},Array.from({length:i},function(e,n){return n}).map(function(e){var n,d,p;return D.createElement(D.Fragment,{key:e},b({value:(n=k()[e])!==null&&n!==void 0?n:"",placeholder:(p=(d=J())===null||d===void 0?void 0:d[e])!==null&&p!==void 0?p:void 0,ref:function(x){return g.current[e]=x},onChange:W,onFocus:function(x){return H(x)(e)},onBlur:Q,onKeyDown:Y,onPaste:Z,autoComplete:"off","aria-label":"Please enter OTP character ".concat(e+1),style:Object.assign(E?{}:{width:"1em",textAlign:"center"},z(w)?w:{}),className:typeof w=="string"?w:void 0,type:a,inputMode:L?"numeric":"text",onInput:X},e),e<i-1&&(typeof S=="function"?S(e):S))}))};const De=({mobile:r,referenceId:o,isOpen:m,setIsOpen:c})=>{const[i,l]=j.useState(!0),s=ie(),[b,v]=j.useState(0),y=U(),[f,a]=j.useState(""),S=()=>{o!==""&&f!==""&&y(Se(s,o,f))},N=()=>{l(!0),a(""),y(Pe(o)),v(h=>h+1)};return j.useEffect(()=>{f.length===6&&S()},[f]),t.jsx(le,{static:!0,open:m,onClose:()=>c(!1),className:"relative z-50",children:t.jsx("div",{className:"fixed inset-0 flex w-screen items-center justify-center p-2 bg-primary/50 backdrop-blur-lg",children:t.jsxs(oe,{className:"space-y-4 border bg-primary-50 p-2 rounded-lg shadow-lg text-center text-primary",children:[t.jsx(ce,{className:"font-semibold text-xl",children:"OTP Verification"}),t.jsxs(ue,{className:"text-gray-500 px-5",children:["Please check the mobile and enter the verification code",t.jsx("br",{}),"(",ve(r),")"]}),t.jsx("div",{className:"flex justify-center",children:t.jsx(de,{size:100,isPlaying:!0,duration:60,colors:["#1e3a8a","#1e40af","#1d4ed8","#be123c"],colorsTime:[60,40,10,0],onComplete:()=>{l(!1)},children:({remainingTime:h})=>h},b)}),t.jsx("div",{className:"bg-gray-200 rounded-lg flex justify-center items-center",children:t.jsx(we,{containerStyle:"flex flex-1 justify-between items-center px-5 py-5",value:f,onChange:a,numInputs:6,renderSeparator:t.jsx("span",{children:" "}),renderInput:h=>t.jsx("input",{...h}),inputStyle:{width:"2.5rem",height:"2.5rem",fontSize:"1.5rem",borderRadius:"0.5rem",border:"1px solid #1c34c6"}})}),t.jsx("div",{className:"flex justify-center sm:justify-end gap-4",children:t.jsx(K,{onClick:()=>N(),variant:"secondary",disabled:i,children:"Resend"})})]})})})},Ie=r=>async o=>{var m,c,i,l;o(me());try{const s=await B.post("/master/v2",r);o(fe(s.data)),O.success(s.data.message)}catch(s){s?(o(G((c=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:c.error)),O.error((l=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:l.error)):o(G("An unknown error occurred"))}},Oe=ye({nic:V().min(1,"NIC Number is required").regex(/^(?:\d{9}[vVxX]|\d{12})$/,"Invalid NIC number"),email:V().min(1,"Email Address is required").email("Invalid email address (e.g. sample@sample.com)"),mobileNumber:V().min(1,"Mobile Number is required").regex(/^(?:[0-9]{10})$/,"Invalid phone number (e.g. 0712345678)")}),ke=()=>{var w,T,E,C,u,I;const r=pe(),m=new URLSearchParams(r.search).get("ved"),{register:c,handleSubmit:i,formState:{errors:l}}=be({resolver:je(Oe)}),[s,b]=j.useState(!1),[v,y]=j.useState(null),f=U(),{data:a,loading:S}=he(g=>g.userLogin),N=j.useCallback(g=>{y(g),f(Ie({...g,identifire:m??null}))},[]),h=j.useMemo(()=>v&&(a==null?void 0:a.stage)!=="COMPLETED"&&t.jsx(De,{setIsOpen:b,isOpen:s,mobile:v.mobileNumber,referenceId:(a==null?void 0:a.referenceNo)??""}),[a==null?void 0:a.referenceNo]);return j.useEffect(()=>{a!==null&&b(!0)},[a]),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-card-pattern flex justify-center items-center min-h-screen",children:t.jsxs("div",{className:"bg-primary-50 p-8 rounded-lg shadow-md w-full my-2 max-w-md animate-fade-up animate-duration-[3000ms] animate-once",children:[t.jsx("img",{className:"w-32 mb-3 animate-fade-up animate-duration-[1200ms] animate-once",src:ge}),t.jsxs("div",{className:"bg-white border rounded-lg p-3 text-primary-950 animate-fade-up animate-duration-[1500ms] animate-once",children:[t.jsx("h3",{className:"text-base mb-2",children:"Welcome to LOLC Credit Card"}),t.jsx("h3",{className:"text-sm mb-2",children:"Required Documents"}),t.jsxs("ul",{className:"list-disc list-inside text-sm",children:[t.jsxs("li",{className:"",children:["NIC or Driving License ",t.jsx("br",{}),"    (Both Sides)"]}),t.jsxs("li",{className:"",children:["Income Proof ",t.jsx("br",{}),"    (Latest Payslip or 03 months Bank Statements)"]}),t.jsxs("li",{className:"",children:["Billing Proof ",t.jsx("br",{}),"    (Electricity/ Water Bill)"]})]}),t.jsxs("p",{className:"mt-3 text-sm",children:["Use gallery to select and attach multiple documents.",t.jsx("br",{}),"Allowed document types - (PDF, JPG, JPEG, PNG)"]})]}),t.jsx("form",{onSubmit:i(N),children:t.jsxs("div",{className:"flex flex-col gap-5 mt-3 animate-fade-up animate-duration-[2000ms] animate-once",children:[t.jsx(M,{type:"text",label:"NIC",error:(T=(w=l==null?void 0:l.nic)==null?void 0:w.message)==null?void 0:T.toString(),required:!0,...c("nic")}),t.jsx(M,{type:"tel",label:"Mobile",error:(C=(E=l==null?void 0:l.mobileNumber)==null?void 0:E.message)==null?void 0:C.toString(),required:!0,...c("mobileNumber"),ruleLabel:"Enter mobile number (e.g. 0712345678)"}),t.jsx(M,{type:"email",label:"Email",className:"normal-case",error:(I=(u=l==null?void 0:l.email)==null?void 0:u.message)==null?void 0:I.toString(),required:!0,...c("email")}),t.jsxs(K,{type:"submit",variant:"primary",className:"w-full flex flex-row items-center justify-between gap-2 mt-3",children:["Start ",S?t.jsx(xe,{className:"animate-spin animate-infinite"}):t.jsx(Ne,{})]})]})})]})}),h]})};export{ke as default};
